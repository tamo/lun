<html>
	<head>
		<title>lun - fun learning tool for students</title>
		<meta name="viewport" content="width=device-width,initial-scale=1.0">
		<style>
			p {font-size: 130%;}
			button {font-size: 200%; display: block;}
		</style>
	</head>
	<body>
		<p id="q"></p>
		<button id="next">‚è≠Ô∏è</button>
		<script>
			const datafile = new XMLHttpRequest();
			datafile.open("GET", "./taihei-2-summer-2021.txt", true);
			datafile.send(null);
			datafile.onload = function(){
				const lines = datafile.responseText.split("\n");
				let qa = [];
				lines.forEach(function(line){
					let pair = line.split("|");
					if (pair.length == 2){
						qa.push(pair);
					} else {
						console.log("[not a qa] " + pair);
					}
				})
				qa.sort(function(a, b){
					return Math.random() - 0.5;
				})
				const next = document.getElementById("next");
				next.addEventListener("click", function(e){
					q_array = qa.pop();
					const q = document.getElementById("q");
					q.innerHTML = "<button id='q_txt'>"
						+ q_array[1]
						+ "</button>"
						+ "<button id='a_pron'>üîä</button>";
					let a_pron_func = function(e){
						let u = new SpeechSynthesisUtterance();
						u.lang = "en-US";
						u.text = q_array[0];
						speechSynthesis.speak(u);
					}
					let a_pron = document.getElementById("a_pron");
					a_pron.addEventListener("click", a_pron_func);
					let q_txt = document.getElementById("q_txt");
					q_txt.addEventListener("click", function(e){
						q.innerHTML += "<p id='a_txt'>"
							+ q_array[0]
							+ "</p>";
						let a_pron = document.getElementById("a_pron");
						a_pron.addEventListener("click", a_pron_func);
					});
				});
			};
		</script>
	</body>
</html>